{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Utsav%20Prajapati/Downloads/manhar-total-solution-website%20%282%29/manhar-total-solution-website/app/gallery/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useRef } from \"react\"\nimport Image from \"next/image\"\nimport Link from \"next/link\"\n\ninterface GalleryImage {\n  id: number\n  image_url: string\n  uploaded_by_name: string\n  uploaded_at: string\n}\n\ninterface User {\n  id: number\n  name: string\n  email: string\n  role: string\n}\n\nexport default function GalleryPage() {\n  const [images, setImages] = useState<GalleryImage[]>([])\n  const [user, setUser] = useState<User | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [uploading, setUploading] = useState(false)\n  const [selectedImage, setSelectedImage] = useState<string | null>(null)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  useEffect(() => {\n    fetchImages()\n    checkAuth()\n  }, [])\n\n  const fetchImages = async () => {\n    try {\n      const res = await fetch(\"/api/gallery\")\n      const data = await res.json()\n      setImages(data.images || [])\n    } catch (error) {\n      console.error(\"Failed to fetch images:\", error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const checkAuth = async () => {\n    try {\n      const res = await fetch(\"/api/auth\")\n      const data = await res.json()\n      setUser(data.user)\n    } catch {\n      setUser(null)\n    }\n  }\n\n  const handleUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0]\n    if (!file || !user) return\n\n    setUploading(true)\n    const formData = new FormData()\n    formData.append(\"image\", file)\n\n    try {\n      const res = await fetch(\"/api/gallery\", {\n        method: \"POST\",\n        body: formData },\n      )\n      const data = await res.json()\n      if (data.image) {\n        setImages([data.image, ...images])\n      }\n    } catch (error) {\n      console.error(\"Upload failed:\", error)\n    } finally {\n      setUploading(false)\n      if (fileInputRef.current) fileInputRef.current.value = \"\"\n    }\n  }\n\n  return (\n    <>\n      <section className=\"py-20 bg-gradient-to-br from-blue-50 via-white to-orange-50 dark:from-[#0D1B2A] dark:via-[#1B2838] dark:to-[#0D1B2A] mt-20\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"text-center mb-12\">\n            <h1 className=\"text-5xl font-bold text-[#0D1B2A] dark:text-white mb-4\">\n              Our Gallery\n            </h1>\n            <p className=\"text-xl text-gray-600 dark:text-gray-300\">\n              Explore our work and achievements\n            </p>\n          </div>\n\n          {user && (\n            <div className=\"flex justify-center mb-8\">\n              <label className=\"cursor-pointer px-6 py-3 bg-gradient-to-r from-[#1E73BE] to-[#FF8C42] text-white rounded-xl font-semibold hover:opacity-90 transition flex items-center gap-2\">\n                {uploading ? \"Uploading...\" : \"Upload Image\"}\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"image/jpeg,image/png,image/webp\"\n                  onChange={handleUpload}\n                  className=\"hidden\"\n                  disabled={uploading}\n                />\n              </label>\n            </div>\n          )}\n\n          {!user && (\n            <div className=\"text-center mb-8\">\n              <Link\n                href=\"/login\"\n                className=\"inline-block px-6 py-3 bg-[#1E73BE] text-white rounded-xl font-semibold hover:bg-[#155aa8] transition\"\n              >\n                Login to Upload\n              </Link>\n            </div>\n          )}\n        </div>\n      </section>\n\n      <section className=\"py-20 bg-gray-50 dark:bg-[#0a1421]\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          {loading ? (\n            <div className=\"text-center py-20\">\n              <div className=\"w-12 h-12 border-4 border-[#1E73BE] border-t-transparent rounded-full animate-spin mx-auto\" />\n            </div>\n          ) : images.length === 0 ? (\n            <div className=\"text-center py-20\">\n              <p className=\"text-gray-500 dark:text-gray-400 text-lg\">No images yet</p>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n              {images.map((image, index) => (\n                <div\n                  key={image.id}\n                  className=\"group relative aspect-square rounded-2xl overflow-hidden cursor-pointer\"\n                  style={{ animationDelay: `${index * 100}ms` }}\n                  onClick={() => setSelectedImage(image.image_url)}\n                >\n                  <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10\" />\n                  <Image\n                    src={image.image_url}\n                    alt=\"Gallery\"\n                    fill\n                    className=\"object-cover transition-transform duration-500 group-hover:scale-110\"\n                  />\n                  <div className=\"absolute bottom-0 left-0 right-0 p-4 z-20 translate-y-full group-hover:translate-y-0 transition-transform duration-300\">\n                    <p className=\"text-white text-sm font-medium\">\n                      Uploaded by {image.uploaded_by_name || \"Unknown\"}\n                    </p>\n                  </div>\n                  <div className=\"absolute inset-0 ring-2 ring-white/0 group-hover:ring-white/30 rounded-2xl transition-all duration-300 group-hover:shadow-2xl group-hover:shadow-[#1E73BE]/20\" />\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </section>\n\n      {selectedImage && (\n        <div\n          className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm\"\n          onClick={() => setSelectedImage(null)}\n        >\n          <div className=\"relative max-w-4xl w-full aspect-video rounded-2xl overflow-hidden\">\n            <Image\n              src={selectedImage}\n              alt=\"Preview\"\n              fill\n              className=\"object-contain\"\n            />\n            <button\n              className=\"absolute top-4 right-4 w-10 h-10 bg-white/20 hover:bg-white/40 rounded-full flex items-center justify-center text-white transition\"\n              onClick={() => setSelectedImage(null)}\n            >\n              âœ•\n            </button>\n          </div>\n        </div>\n      )}\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}