{"version":3,"sources":["../../../../../../../Downloads/manhar-total-solution-website%20%282%29/manhar-total-solution-website/app/gallery/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useRef } from \"react\"\nimport Image from \"next/image\"\nimport Link from \"next/link\"\n\ninterface GalleryImage {\n  id: number\n  image_url: string\n  uploaded_by_name: string\n  uploaded_at: string\n}\n\ninterface User {\n  id: number\n  name: string\n  email: string\n  role: string\n}\n\nexport default function GalleryPage() {\n  const [images, setImages] = useState<GalleryImage[]>([])\n  const [user, setUser] = useState<User | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [uploading, setUploading] = useState(false)\n  const [selectedImage, setSelectedImage] = useState<string | null>(null)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n\n  useEffect(() => {\n    fetchImages()\n    checkAuth()\n  }, [])\n\n  const fetchImages = async () => {\n    try {\n      const res = await fetch(\"/api/gallery\")\n      const data = await res.json()\n      setImages(data.images || [])\n    } catch (error) {\n      console.error(\"Failed to fetch images:\", error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const checkAuth = async () => {\n    try {\n      const res = await fetch(\"/api/auth\")\n      const data = await res.json()\n      setUser(data.user)\n    } catch {\n      setUser(null)\n    }\n  }\n\n  const handleUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0]\n    if (!file || !user) return\n\n    setUploading(true)\n    const formData = new FormData()\n    formData.append(\"image\", file)\n\n    try {\n      const res = await fetch(\"/api/gallery\", {\n        method: \"POST\",\n        body: formData },\n      )\n      const data = await res.json()\n      if (data.image) {\n        setImages([data.image, ...images])\n      }\n    } catch (error) {\n      console.error(\"Upload failed:\", error)\n    } finally {\n      setUploading(false)\n      if (fileInputRef.current) fileInputRef.current.value = \"\"\n    }\n  }\n\n  return (\n    <>\n      <section className=\"py-20 bg-gradient-to-br from-blue-50 via-white to-orange-50 dark:from-[#0D1B2A] dark:via-[#1B2838] dark:to-[#0D1B2A] mt-20\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"text-center mb-12\">\n            <h1 className=\"text-5xl font-bold text-[#0D1B2A] dark:text-white mb-4\">\n              Our Gallery\n            </h1>\n            <p className=\"text-xl text-gray-600 dark:text-gray-300\">\n              Explore our work and achievements\n            </p>\n          </div>\n\n          {user && (\n            <div className=\"flex justify-center mb-8\">\n              <label className=\"cursor-pointer px-6 py-3 bg-gradient-to-r from-[#1E73BE] to-[#FF8C42] text-white rounded-xl font-semibold hover:opacity-90 transition flex items-center gap-2\">\n                {uploading ? \"Uploading...\" : \"Upload Image\"}\n                <input\n                  ref={fileInputRef}\n                  type=\"file\"\n                  accept=\"image/jpeg,image/png,image/webp\"\n                  onChange={handleUpload}\n                  className=\"hidden\"\n                  disabled={uploading}\n                />\n              </label>\n            </div>\n          )}\n\n          {!user && (\n            <div className=\"text-center mb-8\">\n              <Link\n                href=\"/login\"\n                className=\"inline-block px-6 py-3 bg-[#1E73BE] text-white rounded-xl font-semibold hover:bg-[#155aa8] transition\"\n              >\n                Login to Upload\n              </Link>\n            </div>\n          )}\n        </div>\n      </section>\n\n      <section className=\"py-20 bg-gray-50 dark:bg-[#0a1421]\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          {loading ? (\n            <div className=\"text-center py-20\">\n              <div className=\"w-12 h-12 border-4 border-[#1E73BE] border-t-transparent rounded-full animate-spin mx-auto\" />\n            </div>\n          ) : images.length === 0 ? (\n            <div className=\"text-center py-20\">\n              <p className=\"text-gray-500 dark:text-gray-400 text-lg\">No images yet</p>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n              {images.map((image, index) => (\n                <div\n                  key={image.id}\n                  className=\"group relative aspect-square rounded-2xl overflow-hidden cursor-pointer\"\n                  style={{ animationDelay: `${index * 100}ms` }}\n                  onClick={() => setSelectedImage(image.image_url)}\n                >\n                  <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10\" />\n                  <Image\n                    src={image.image_url}\n                    alt=\"Gallery\"\n                    fill\n                    className=\"object-cover transition-transform duration-500 group-hover:scale-110\"\n                  />\n                  <div className=\"absolute bottom-0 left-0 right-0 p-4 z-20 translate-y-full group-hover:translate-y-0 transition-transform duration-300\">\n                    <p className=\"text-white text-sm font-medium\">\n                      Uploaded by {image.uploaded_by_name || \"Unknown\"}\n                    </p>\n                  </div>\n                  <div className=\"absolute inset-0 ring-2 ring-white/0 group-hover:ring-white/30 rounded-2xl transition-all duration-300 group-hover:shadow-2xl group-hover:shadow-[#1E73BE]/20\" />\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </section>\n\n      {selectedImage && (\n        <div\n          className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm\"\n          onClick={() => setSelectedImage(null)}\n        >\n          <div className=\"relative max-w-4xl w-full aspect-video rounded-2xl overflow-hidden\">\n            <Image\n              src={selectedImage}\n              alt=\"Preview\"\n              fill\n              className=\"object-contain\"\n            />\n            <button\n              className=\"absolute top-4 right-4 w-10 h-10 bg-white/20 hover:bg-white/40 rounded-full flex items-center justify-center text-white transition\"\n              onClick={() => setSelectedImage(null)}\n            >\n              âœ•\n            </button>\n          </div>\n        </div>\n      )}\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}